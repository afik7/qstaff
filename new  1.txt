1Держите папочку с exe и библиотеками. програмуля запускается без компилятора
попробуйте.
2Файлик ккк.xls для экспорта  (   еще одни входные данные)
 
 


Процесс проектирования производится в терминах реляционной модели данных методом последовательных приближений к удовлетворительному набору схем отношений. Исходной точкой является представление предметной области в виде одного или нескольких отношений, и на каждом шаге проектирования производится некоторый набор схем отношений, обладающих лучшими свойствами. Процесс проектирования представляет собой процесс нормализации схем отношений, причем каждая следующая нормальная форма обладает свойствами лучшими, чем предыдущая.

Каждой нормальной форме соответствует некоторый определенный набор ограничений, и отношение находится в некоторой нормальной форме, если удовлетворяет свойственному ей набору ограничений. Примером набора ограничений является ограничение первой нормальной формы - значения всех атрибутов отношения атомарны. Поскольку требование первой нормальной формы является базовым требованием классической реляционной модели данных, считаем, что исходный набор отношений уже соответствует этому требованию.  Вторая нормальная форма  предполагает, что единственным ключом отношения является первичный ключ. Модель во второй нормальной форме (см рис....) Модель заданной предметной области изначально соответствовала и этому требованию. Однако в модели были транзитивные зависимости, которые в дальнейшем усложнили бы поддержку и использование базы. Поэтому модель во 2 нормальной форме была приведена к 3 нормальной форме в которой каждый неключевой атрибут нетранзитивно зависит от первичного ключа. Преобразование было сделано за счет наложения дополнительного условия на значения внешних ключей - запрет использования NULL и оптимизации связей между отношениями за счет объединения некоторых отношений. На базе модели в 3 н форме была построена физическая схема БД(см рис).
Как видно на схеме БД staff состоит из 6 таблиц. И распиши что за таблицы.

Потом к таблицам было добавлено 6 отображений (таблицы, создающиеся посредством запросов которые хранятья в БД)
Отображение для получения всех данных по пенсионерам
select  get_age3.surname as surname, get_age3.name as name, 
get_age3.patronomic as patronomic, 
get_age3.id_gender as id_gender,
cast(get_age3.age as real) as age,
DOB
from get_age3,agepention_catalog
 where 
strftime('%s', DOB) between 
strftime('%s', agepention_catalog.DOBbegin)
 and strftime('%s', agepention_catalog.DOBend)
 
  and id_pention!=2
  and get_age3.age >=agepention_catalog.age
and  agepention_catalog.id_gender=get_age3.id_gender
order by id_gender


итд